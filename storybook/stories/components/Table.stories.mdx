
import { Canvas, Meta, Story, ArgsTable, Source } from '@storybook/addon-docs';
import SortableTable from '@shell/components/SortableTable';

<Meta 
  title="Components/Table"
  component={SortableTable}
/>

export const Template = (args, { argTypes, events }) => ({
  components: { SortableTable },
  props:      Object.keys(argTypes),
  template:   `<SortableTable v-bind="$props">
                  <template v-if="${'loadingSlot' in args}" v-slot:loading>${args.loadingSlot}</template>
                  <template v-if="${'noRowSlot' in args}" v-slot:no-rows>${args.noRowSlot}</template>
                  <template v-if="${'noResultsSlot' in args}" v-slot:no-results>${args.noResultsSlot}</template>
                  <template v-if="${'titleSlot' in args}" v-slot:title>${args.titleSlot}</template>
                  <template v-if="${'headerLeftSlot' in args}" v-slot:header-left>${args.headerLeftSlot}</template>
                  <template v-if="${'headerMiddleSlot' in args}" v-slot:header-middle>${args.headerMiddleSlot}</template>
                  <template v-if="${'headerRightSlot' in args}" v-slot:header-right>${args.headerRightSlot}</template>
                  <template v-if="${'headerButtonSlot' in args}" v-slot:header-button>${args.headerButtonSlot}</template>
                  <template v-if="${'groupRowSlot' in args}" v-slot:group-row>${args.groupRowSlot}</template>
                  <template v-if="${'groupBySlot' in args}" v-slot:group-by>${args.groupBySlot}</template>
                  <template v-if="${'mainRowSlot' in args}" v-slot:main-row>${args.mainRowSlot}</template>
                  <template v-if="${'mainRowISlot' in args}" v-slot:"main-row:0">${args.mainRowISlot}</template>
                  <template v-if="${'colISlot' in args}" v-slot:"col:name">${args.colISlot}</template>
                  <template v-if="${'cellISlot' in args}" v-slot:"cell:name">${args.cellISlot}</template>
                  <template v-if="${'rowActionsSlot' in args}" v-slot:row-actions>${args.rowActionsSlot}</template>
                  <template v-if="${'subRowSlot' in args}" v-slot:sub-row>${args.subRowSlot}</template>
                  <template v-if="${'shortkeysSlot' in args}" v-slot:shortkeys>${args.shortkeysSlot}</template>
               </SortableTable>`
});

export const textSlotArea = (text) => `<div style="background: red; color: white">${text}</div>`;
export const getButton = (text) => `<button className="btn role-primary">${text}</button>`;

export const rows = [
  {
    name: 'First row',
    description: 'This is the first row',
    type: 'first type',
  },
  {
    name: 'Second row',
    description: 'This is another row',
    type: 'first type',
  },
  {
    name: 'No description',
    description: '',
    type: 'second type',
  },
];

export const headers = [
  {
    name: 'name',
    label: 'Name',
  },
  {
    name: 'description',
    label: 'Description',
  },
  {
    name: 'type',
    label: 'Type',
  },
];

# Table

Table with multiple functionalities. 

Note: Within our project 2 tables exists for this purpose: `SortableTable` and `ResourceTable`. 
The first one is an abstracted version, while the `ResourceTable` is a wrapper bound to the state.

## Description

This is just a visual rapresentation of the Rancher tables.
As the component ties in to product config, models, stores, etc, consider some existing docs as well during the development

- https://rancher.github.io/dashboard/code-base-works/sortable-table
- https://rancher.github.io/dashboard/code-base-works/kubernetes-resources-data-load
- https://rancher.github.io/dashboard/code-base-works/customising-how-k8s-resources-are-presented#list

<br/>

### Styles and sections

#### Default view

Default view case without change any prop and just providing required data.

<Canvas>
  <Story
    name="Default view"
    args={{
      headers,
      rows,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>

#### Grouped

Rows can be grouped by matching types.

<Canvas>
  <Story
    name="Grouped view"
    args={{
      headers,
      rows,
      groupBy: 'type',
    }}>
    {Template.bind({})}
  </Story>
</Canvas>

#### Simplified

The default table can also be stripped out of each interactive functionality by props.

<Canvas>
  <Story
    name="Simplified view"
    args={{
      headers,
      rows,
      search: false,
      rowActions: false,
      tableActions: false,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Loading

Loading status for the table.

<Canvas>
  <Story
    name="Loading"
    args={{
      headers,
      rows: [],
      loading: true
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Sub rows

Sub rows can be added to each row.

<Canvas>
  <Story
    name="Sub rows"
    args={{
      headers,
      rows,
      subRows: true,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Expandeble Sub rows

Sub rows can be optionally expanded.

<Canvas>
  <Story
    name="Expandable Sub rows"
    args={{
      headers,
      rows,
      subRows: true,
      subExpandable: true,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


subRows

#### Slots

#### Custom Loading slot

Custom loading slot element.

<Canvas>
  <Story
    name="Custom Loading slot"
    args={{
      headers,
      rows: [],
      loading: true, 
      loadingSlot: textSlotArea(`Loading...`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Custom No Row slot

Custom no row element.

<Canvas>
  <Story
    name="Custom No Row slot"
    args={{
      headers,
      rows: [],
      noRowSlot: textSlotArea(`No row found`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Custom No Results slot

Custom no results element, got while searching for an entry without results.

<Canvas>
  <Story
    name="Custom No Results slot"
    args={{
      headers,
      rows: [],
      noResultsSlot: textSlotArea(`No result found`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Title slot

Title for the table.

<Canvas>
  <Story
    name="Title slot"
    args={{
      headers,
      rows: [],
      titleSlot: textSlotArea(`Table title`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Header Buttons slots

Slots reserved for adding elements on the header, e.g. buttons.
Areas are left, middle, right and generic.

<Canvas>
  <Story
    name="Header Buttons slot"
    args={{
      headers,
      rows: [],
      headerLeftSlot: textSlotArea(getButton('Left button')),
      headerMiddleSlot: textSlotArea(getButton('Middle button')),
      headerRightSlot: textSlotArea(getButton('Right button')),
      headerButtonSlot: textSlotArea(getButton('Header Button'))
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Group Row and Group By slots

Elements added in case of groupped rows using `groupBy`.

<Canvas>
  <Story
    name="Group Row slot"
    args={{
      headers,
      rows,
      groupBy: 'type',
      groupRowSlot: textSlotArea(`Group row slot`),
      groupBySlot: textSlotArea(`Group by slot`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>




#### Main Row 	slot

<Canvas>
  <Story
    name="Main Row  slot"
    args={{
      headers,
      rows,
      mainRowSlot: textSlotArea(`Main row slot`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Main Row Key	slot

<Canvas>
  <Story
    name="Main Row Key slot"
    args={{
      headers,
      rows,
      mainRowISlot: textSlotArea(`Main row for this row slot`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Column Name	slot

<Canvas>
  <Story
    name="Column Name slot"
    args={{
      headers,
      rows,
      colISlot: textSlotArea(`Slot to replace this column`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Cell Name	slot

<Canvas>
  <Story
    name="Cell Name slot"
    args={{
      headers,
      rows,
      cellISlot: textSlotArea(`Slot to replace this cell`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Row actions slot

<Canvas>
  <Story
    name="Row actions slot"
    args={{
      headers,
      rows,
      rowActionsSlot: textSlotArea(`Row actions slot`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Sub Row slot

<Canvas>
  <Story
    name="Sub Row slot"
    args={{
      headers,
      rows,
      subRowSlot: textSlotArea(`Sub row slot`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Shortkeys slot

Footer area slot used to add messages related to shortkeys.

<Canvas>
  <Story
    name="Shortkeys slot"
    args={{
      headers,
      rows: [],
      shortkeysSlot: textSlotArea(`Use CMD+W to close this tab :)`)
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


### Functionalities

#### Advanced Filtering

Entries can be optionally filtered by key and term or optionally hide them.

<Canvas>
  <Story
    name="Advanced Filtering"
    args={{
      headers,
      rows,
      hasAdvancedFiltering: true,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Sorting

Sorting is defined by header configuration using the key `sort` and a list of key to be used.

<Canvas>
  <Story
    name="Sorting"
    args={{
      headers: headers.map(header => ({ ...header, sort: ['name'] })),
      rows,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>

#### Action menu

Row can have action menu enabled by the configuration `rowActions`.

<Canvas>
  <Story
    name="Action menu"
    args={{
      headers,
      rows,
    }}>
    {Template.bind({})}
  </Story>
</Canvas>


#### Pagination

Table pagination can be enabled with `paging` and set the amount of entries with `rowsPerPage`.

<Canvas>
  <Story
    name="Pagination"
    args={{
      headers,
      rows: Array.from(new Array(100)).map((el, i) => ({
        name: `Row ${i}`,
      })),
      paging: true,
      rowsPerPage: 5
    }}>
    {Template.bind({})}
  </Story>
</Canvas>

#### Context menu

## Props table

<ArgsTable of={SortableTable} />
