<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-testing/e2e-test">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<title data-rh="true">E2E Tests | Rancher UI DevKit</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rancher.github.io/dashboard/testing/e2e-test"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="E2E Tests | Rancher UI DevKit"><meta data-rh="true" name="description" content="This repo is configured for end-to-end testing with Cypress and the CI will run using a blank state of Rancher executed locally. The aim is however to enable also tests using remote instances of Ranchers."><meta data-rh="true" property="og:description" content="This repo is configured for end-to-end testing with Cypress and the CI will run using a blank state of Rancher executed locally. The aim is however to enable also tests using remote instances of Ranchers."><link data-rh="true" rel="icon" href="/dashboard/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://rancher.github.io/dashboard/testing/e2e-test"><link data-rh="true" rel="alternate" href="https://rancher.github.io/dashboard/testing/e2e-test" hreflang="en"><link data-rh="true" rel="alternate" href="https://rancher.github.io/dashboard/testing/e2e-test" hreflang="x-default"><link rel="stylesheet" href="/dashboard/assets/css/styles.0f7dabe3.css">
<link rel="preload" href="/dashboard/assets/js/runtime~main.e7130255.js" as="script">
<link rel="preload" href="/dashboard/assets/js/main.66be629e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dashboard/"><div class="navbar__logo"><img src="/dashboard/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/dashboard/img/rancher-logo.svg" alt="Rancher Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">UI DevKit</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dashboard/home">Docs</a><a href="https://rancher.github.io/storybook/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Components &amp; Design kit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dashboard/home">Developer Documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dashboard/getting-started/quickstart">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dashboard/guide/build-for-container-registry">Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dashboard/code-base-works/api-resources-and-schemas">How the Code Base Works</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dashboard/extensions/introduction">Extensions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dashboard/storybook">Storybook</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/dashboard/testing/unit-test">Testing</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dashboard/testing/unit-test">Unit Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dashboard/testing/e2e-test">E2E Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dashboard/testing/stress-test">Stress Testing</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dashboard/terminology">Terminology</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/dashboard/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Testing</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">E2E Tests</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>E2E Tests</h1><p>This repo is configured for end-to-end testing with <a href="https://docs.cypress.io/api/table-of-contents" target="_blank" rel="noopener noreferrer">Cypress</a> and the CI will run using a blank state of Rancher executed locally. The aim is however to enable also tests using remote instances of Ranchers.</p><p>Because of this, we extend the <a href="https://docs.cypress.io/guides/references/best-practices#How-It-Works" target="_blank" rel="noopener noreferrer">Cypress best practices</a>, so be sure to read them before write any test.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="initial-setup">Initial Setup<a class="hash-link" href="#initial-setup" title="Direct link to heading">​</a></h2><p>For the cypress test runner to consume the UI, you should specify the environment variables. This may change based on the type of tests you may want to run.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-for-remote-tests">Setup for remote tests<a class="hash-link" href="#setup-for-remote-tests" title="Direct link to heading">​</a></h3><p>For tests against a deployed Rancher, e.g. on Digital Ocean, mainly for analyzing the project current state.</p><ul><li><code>TEST_USERNAME</code>, default <code>admin</code></li><li><code>TEST_PASSWORD</code>, user password or custom during first Rancher run</li><li><code>TEST_BASE_URL</code>, the address of your instance</li><li><code>TEST_SKIP_SETUP=true</code>, we avoid setup as your instance is already set</li></ul><blockquote><p>Note: If you want to generate code coverage information, you must enable code instrumentation by setting <code>TEST_INSTRUMENT</code> to <code>true</code>.</p></blockquote><p>Finally run one of the 2 commands:</p><ul><li><code>yarn cy:open</code>, if you want to select the tests</li><li><code>yarn cy:run</code>, if you want to run ALL the tests</li></ul><p>For further information, consult <a href="https://docs.cypress.io/guides/guides/command-line#cypress-open" target="_blank" rel="noopener noreferrer">official documentation</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-for-local-tests">Setup for local tests<a class="hash-link" href="#setup-for-local-tests" title="Direct link to heading">​</a></h3><p>These types of tests are aimed for development and updates.</p><p>NOTE: Local setup of Rancher do not work on Mac with M1 chips.</p><ul><li><code>API</code>, the address of your server (e.g. DO), it may be local or hosted (e.g. you have Mac M1)</li><li><code>TEST_USERNAME</code>, default <code>admin</code></li><li><code>TEST_PASSWORD</code>, user password or custom during first Rancher run</li><li><code>CATTLE_BOOTSTRAP_PASSWORD</code>, initialization password which will also be used as <code>admin</code> user password (do not pick <code>admin</code> as password as it generates issues)</li><li><code>TEST_BASE_URL=https://localhost:8005</code></li><li><code>TEST_SKIP_SETUP=false</code>, avoid to execute bootstrap setup tests for already initialized Rancher instances, it has to be toggled in case of new instances</li></ul><p>You will have to run your local instance at this point:</p><ul><li><code>yarn dev</code></li></ul><p>Finally run one of the 2 commands:</p><ul><li><code>yarn cy:open</code>, if you want to select the tests from the browser</li><li><code>yarn cy:run</code>, if you want to run ALL the tests in background</li></ul><p>For further information, consult <a href="https://docs.cypress.io/guides/guides/command-line#cypress-open" target="_blank" rel="noopener noreferrer">official documentation</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-for-dashboard-purposes-only">Setup for dashboard purposes ONLY<a class="hash-link" href="#setup-for-dashboard-purposes-only" title="Direct link to heading">​</a></h3><p>If you want your tests to be tracked on Cypress dashboards you will have to enable the following:</p><ul><li><code>TEST_PROJECT_ID</code> // Project ID used by Cypress/Sorry cypress to run the tests</li><li><code>TEST_RUN_ID</code> (optional) // Identifier for your dashboard run, default value is timestamp</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="e2e-dashboard">E2E Dashboard<a class="hash-link" href="#e2e-dashboard" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="self-hosted-sorry-cypress">Self-hosted: Sorry Cypress<a class="hash-link" href="#self-hosted-sorry-cypress" title="Direct link to heading">​</a></h3><p>Link to the dashboard: <a href="http://139.59.134.103:8080/" target="_blank" rel="noopener noreferrer">http://139.59.134.103:8080/</a></p><p>E2E tests can be added and displayed in a dashboard by defining the project ID with the env var <code>TEST_PROJECT_ID</code>, then run the script:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> cy:run:sorry</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cypress-dashboard-installation-guide">Cypress dashboard installation guide<a class="hash-link" href="#cypress-dashboard-installation-guide" title="Direct link to heading">​</a></h3><p>The setup is done using a cloud hosting service and with its IP we configured the Sorry Cypress as indicated in the <a href="https://docs.sorry-cypress.dev/guide/dashboard-and-api" target="_blank" rel="noopener noreferrer">guide</a>. The process is straightforward, except for the IP which is required to be overwritten within <code>minio.yml</code> manifest as the default <code>http://localhost</code> value generate CORS issues.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cypress-dashboard">Cypress Dashboard<a class="hash-link" href="#cypress-dashboard" title="Direct link to heading">​</a></h3><p>E2E tests can be displayed in Cypress dashboard by defining the project ID with the env var <code>TEST_PROJECT_ID</code>, then run the script by passing the parameters</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> cy:run --record --key YOUR_RECORD_KEY_HERE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>These values are provided when you create a new project within Cypress dashboard or within <code>Project settings</code>.</p><p>It&#x27;s also possible to run a workflow in GitHub Actions E2E test using these values to record on personal dashboards.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="local-and-ciprod-run">Local and CI/prod run<a class="hash-link" href="#local-and-ciprod-run" title="Direct link to heading">​</a></h2><p>It is possible to start the project and run all the tests at once with a single command. There&#x27;s however a difference between <code>dev</code> and <code>production</code> run. The first will not require an official certificate and will build the project in <code>.nuxt</code>, while the production will enable all the SSL configurations to run encrypted.</p><ul><li><code>yarn e2e:pre-dev</code>, to optionally initialize Docker and build the project, if not already done</li><li><code>yarn e2e:dev</code>, single run local development</li><li><code>yarn e2e:pre-prod</code>, to optionally initialize Docker and build the project, required for GitHub Actions</li><li><code>yarn e2e:dev</code>, for production use case and CI, which will also restart Docker and build the project</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-commands">Custom Commands<a class="hash-link" href="#custom-commands" title="Direct link to heading">​</a></h2><p>As Cypress common practice, some custom commands have been created within <code>command.ts</code> file to simplify the development process. Please consult Cypress documentation for more details about when and how to use them.</p><p>Worth mentioning the <code>cy.getId()</code> and <code>cy.findId()</code> commands, as it is mainly used to select elements. This would require to add <code>data-testid</code> to your element inside the markup and optionally matchers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="writing-tests">Writing tests<a class="hash-link" href="#writing-tests" title="Direct link to heading">​</a></h2><p>Test specs should be grouped logically, normally by page or area of the Dashboard but also by a specific feature or component.</p><p>Tests should make use of common Page Object (PO) components. These can be pages or individual components which expose a useful set of tools, but most importantly contain the selectors for the DOM elements that need to be used. These will ensure changes to the underlying components don&#x27;t require a rewrite of many many tests. They also allow parent components to easily search for children (for example easily finding all anchors in a section instead of the whole page). Given that tests are typescript it should be easy to explore the functionality.</p><p>Some examples of PO functionality</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HomePage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">gotTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">HomePagePo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">checkIsCurrentPage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BurgerMenuPo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clusters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AsyncButtonPO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;[data-testid=&quot;my-button&quot;]&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isDisabled</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">LoginPagePo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">username</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>POs all inherit a root <code>component.po</code>. Common component functionality can be added there. They also expose their core cypress (chainable) element.</p><p>There are a large number of pages and components in the Dashboard and only a small set of POs. These will be expanded as the tests grow.</p><p>Note: When selecting an element be sure to use the attribute <code>data-testid</code>, even in case of lists where elements are distinguished by an index suffix.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tips">Tips<a class="hash-link" href="#tips" title="Direct link to heading">​</a></h2><p>The Cypress UI is very much your friend. There you can click pick tests to run, easily visually track the progress of the test, see the before/after state of each cypress command (specifically good for debugging failed steps), see https requests, etc.</p><p>Tests can also be restricted before cypress runs, or at run time, by prepending <code>.only</code> to the run.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">describe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">only</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Burger Side Nav Menu&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  beforeEach</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">it</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">only</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Opens and closes on menu icon click&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-testid-naming">Data testid naming<a class="hash-link" href="#data-testid-naming" title="Direct link to heading">​</a></h2><p>While defining naming, always consider deterministic usage and rely on specific values. For cases where the content is required, e.g. select name specific elements as in cluster selection, consider use the <code>contain()</code> method. Further guideline and explanation in the official documentation related section.</p><p>In case of complex component, define a prefix for your <code>data-testid</code> with a the prop <code>componentTestid</code> and a default value. This will help you to define unique value and composable identifier in case of more elements, as well to avoid custom term for each test if not necessary, e.g. no multiple elements.</p><p>E.g. given the action menu:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Inherited global identifier prefix for tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Define a term based on the parent component to avoid conflicts on multiple components</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">componentTestid</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">    String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;action-menu&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">v-for</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">(option, i) in options</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">:key</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">opt.action</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">  </span><span class="token tag attr-name" style="color:#00a4db">:data-testid</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">componentTestid + </span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">-</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c"> + i + </span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">-item</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f"></span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging">Debugging<a class="hash-link" href="#debugging" title="Direct link to heading">​</a></h2><p>To summarize what <a href="https://docs.cypress.io/guides/guides/debugging" target="_blank" rel="noopener noreferrer">defined in the documentation</a>, the following modalities of debugging are provided:</p><ul><li><code>debugger</code> flag</li><li><code>.debug()</code> as chained command</li><li><code>cy.pause()</code> for analyzing the state of the test</li><li>Inspect commands in the Cypress dashboard to view the logs</li><li><code>.then(console.log)</code> to append the log to the resolved promise</li></ul><p>These values are provided when you create a new project within Cypress dashboard or within <code>Project settings</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="coverage">Coverage<a class="hash-link" href="#coverage" title="Direct link to heading">​</a></h2><p>Both unit and E2E tests generate coverage respectively with Jest and NYC. These values are generated on both PR and push to <code>master</code> and <code>release</code> after merging. The service used to display the values is Codecov and can be found <a href="https://app.codecov.io/gh/rancher/dashboard" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Special attention goes to the E2E as the code is instrumented with Babel and the configuration is set within Nuxt.js.</p><blockquote><p> Note: To enable instrumentation required for code coverage, you must set the environment variable <code>TEST_INSTRUMENT</code> to <code>true</code>.</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-02-23T17:58:03.000Z">Feb 23, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/dashboard/testing/unit-test"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Unit Tests</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dashboard/testing/stress-test"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Stress Testing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#initial-setup" class="table-of-contents__link toc-highlight">Initial Setup</a><ul><li><a href="#setup-for-remote-tests" class="table-of-contents__link toc-highlight">Setup for remote tests</a></li><li><a href="#setup-for-local-tests" class="table-of-contents__link toc-highlight">Setup for local tests</a></li><li><a href="#setup-for-dashboard-purposes-only" class="table-of-contents__link toc-highlight">Setup for dashboard purposes ONLY</a></li></ul></li><li><a href="#e2e-dashboard" class="table-of-contents__link toc-highlight">E2E Dashboard</a><ul><li><a href="#self-hosted-sorry-cypress" class="table-of-contents__link toc-highlight">Self-hosted: Sorry Cypress</a></li><li><a href="#cypress-dashboard-installation-guide" class="table-of-contents__link toc-highlight">Cypress dashboard installation guide</a></li><li><a href="#cypress-dashboard" class="table-of-contents__link toc-highlight">Cypress Dashboard</a></li></ul></li><li><a href="#local-and-ciprod-run" class="table-of-contents__link toc-highlight">Local and CI/prod run</a></li><li><a href="#custom-commands" class="table-of-contents__link toc-highlight">Custom Commands</a></li><li><a href="#writing-tests" class="table-of-contents__link toc-highlight">Writing tests</a></li><li><a href="#tips" class="table-of-contents__link toc-highlight">Tips</a></li><li><a href="#data-testid-naming" class="table-of-contents__link toc-highlight">Data testid naming</a></li><li><a href="#debugging" class="table-of-contents__link toc-highlight">Debugging</a></li><li><a href="#coverage" class="table-of-contents__link toc-highlight">Coverage</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://slack.rancher.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><span class="footer__link-separator">·</span><a href="https://github.com/rancher/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Rancher. All rights reserved.</div></div></div></footer></div>
<script src="/dashboard/assets/js/runtime~main.e7130255.js"></script>
<script src="/dashboard/assets/js/main.66be629e.js"></script>
</body>
</html>